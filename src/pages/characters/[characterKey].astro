---
import Page from '@layouts/Page.astro';
import CharacterApp from '@svelte/characters/CharacterApp/CharacterApp.svelte';
import { t } from '@utils/i18n';
import { verifySession } from '@utils/server/auth/verifySession';

const { characterKey } = Astro.params;

const hasSession = await verifySession(Astro);

if (!hasSession) {
  Astro.redirect(`/login?redirect=/characters/${characterKey}`);
}

const title = `${t('app:shortname')} â€“ ${t('characters:character.title')}`;
const shortTitle = t('characters:character.title');
const description = t('characters:character.description');
---
<Page
  title={title}
  shortTitle={shortTitle}
  description={description}
  >
    <CharacterApp {characterKey} client:only="svelte"/>
</Page>